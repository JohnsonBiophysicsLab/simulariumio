#!/usr/bin/env python
# -*- coding: utf-8 -*-

import pytest
import numpy as np

from simulariumio.cytosim import (
    CytosimConverter,
    CytosimData,
    CytosimObjectInfo,
    CytosimAgentInfo,
)
from simulariumio import AgentData, MetaData, DimensionData


@pytest.mark.parametrize(
    "trajectory, expected_data",
    [
        (
            CytosimData(
                meta_data=MetaData(
                    box_size=np.array([2.0, 2.0, 2.0]),
                    scale_factor=100.0,
                ),
                object_info={
                    "fibers": CytosimObjectInfo(
                        filepath="simulariumio/tests/data/cytosim/"
                        "aster_pull3D_couples_actin_solid_3_frames/fiber_points.txt",
                        agents={
                            1: CytosimAgentInfo(name="microtubule", radius=0.01),
                            2: CytosimAgentInfo(name="actin", radius=0.01),
                        },
                    ),
                    "solids": CytosimObjectInfo(
                        filepath="simulariumio/tests/data/cytosim/"
                        "aster_pull3D_couples_actin_solid_3_frames/solids.txt",
                        agents={
                            1: CytosimAgentInfo(name="aster", radius=0.1),
                            2: CytosimAgentInfo(name="vesicle", radius=0.1),
                        },
                    ),
                    "singles": CytosimObjectInfo(
                        filepath="simulariumio/tests/data/cytosim/"
                        "aster_pull3D_couples_actin_solid_3_frames/singles.txt",
                        agents={
                            1: CytosimAgentInfo(name="dynein", radius=0.01),
                            2: CytosimAgentInfo(name="kinesin", radius=0.01),
                        },
                    ),
                    "couples": CytosimObjectInfo(
                        filepath="simulariumio/tests/data/cytosim/"
                        "aster_pull3D_couples_actin_solid_3_frames/couples.txt",
                        agents={1: CytosimAgentInfo(name="motor complex", radius=0.02)},
                        position_indices=[3, 4, 5],
                    ),
                },
            ),
            AgentData(
                n_timesteps=3,
                times=np.array([0.0, 0.05, 0.1]),
                n_agents=np.array(
                    [
                        17,
                        17,
                        17,
                    ]
                ),
                viz_types=np.array(
                    [
                        [
                            1001.0,
                            1001.0,
                            1001.0,
                            1001.0,
                            1001.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                        ],
                        [
                            1001.0,
                            1001.0,
                            1001.0,
                            1001.0,
                            1001.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                        ],
                        [
                            1001.0,
                            1001.0,
                            1001.0,
                            1001.0,
                            1001.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                            1000.0,
                        ],
                    ]
                ),
                unique_ids=np.array(
                    [
                        [1, 2, 3, 13, 14, 4, 5, 6, 7, 8, 9, 101, 102, 103, 10, 11, 12],
                        [1, 2, 3, 13, 14, 4, 5, 6, 7, 8, 9, 101, 102, 103, 10, 11, 12],
                        [1, 2, 3, 13, 14, 4, 5, 6, 7, 8, 9, 101, 102, 103, 10, 11, 12],
                    ]
                ),
                types=[
                    [
                        "microtubule",
                        "microtubule",
                        "microtubule",
                        "actin",
                        "actin",
                        "aster",
                        "vesicle",
                        "vesicle",
                        "kinesin",
                        "kinesin",
                        "kinesin",
                        "dynein",
                        "dynein",
                        "dynein",
                        "motor complex",
                        "motor complex",
                        "motor complex",
                    ],
                    [
                        "microtubule",
                        "microtubule",
                        "microtubule",
                        "actin",
                        "actin",
                        "aster",
                        "vesicle",
                        "vesicle",
                        "kinesin",
                        "kinesin",
                        "kinesin",
                        "dynein",
                        "dynein",
                        "dynein",
                        "motor complex",
                        "motor complex",
                        "motor complex",
                    ],
                    [
                        "microtubule",
                        "microtubule",
                        "microtubule",
                        "actin",
                        "actin",
                        "aster",
                        "vesicle",
                        "vesicle",
                        "kinesin",
                        "kinesin",
                        "kinesin",
                        "dynein",
                        "dynein",
                        "dynein",
                        "motor complex",
                        "motor complex",
                        "motor complex",
                    ],
                ],
                positions=np.array(
                    [
                        [
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [36.93, 36.8, 16.78],
                            [78.6, -28.8, 18.04],
                            [-55.09, -33.42, -61.85],
                            [20.61, -39.91, 89.35],
                            [92.82, 32.27, 18.55],
                            [37.56, -80.46, -46.0],
                            [-74.12, 30.31, -59.89],
                            [-61.74, -55.27, -55.98],
                            [-19.37, -9.38, 97.66],
                            [32.63, 38.55, 57.12],
                            [4.42, 20.20, -62.88],
                            [-73.80, -25.20, -43.89],
                        ],
                        [
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [44.86, 34.24, 9.36],
                            [77.18, -36.65, 21.9],
                            [-59.67, -29.66, -65.88],
                            [20.61, -39.91, 89.35],
                            [92.82, 32.27, 18.55],
                            [37.56, -80.46, -46.0],
                            [-74.12, 30.31, -59.89],
                            [-61.74, -55.27, -55.98],
                            [-19.37, -9.38, 97.66],
                            [33.96, 13.31, 50.29],
                            [19.19, 17.69, -76.94],
                            [-72.52, -21.9, -43.59],
                        ],
                        [
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [0.0, 0.0, 0.0],
                            [44.86, 34.24, 9.36],
                            [77.18, -36.65, 21.9],
                            [-59.67, -29.66, -65.88],
                            [20.61, -39.91, 89.35],
                            [92.82, 32.27, 18.55],
                            [37.56, -80.46, -46.0],
                            [-74.12, 30.31, -59.89],
                            [-61.74, -55.27, -55.98],
                            [-19.37, -9.38, 97.66],
                            [33.96, 13.31, 50.29],
                            [19.19, 17.69, -76.94],
                            [-72.52, -21.9, -43.59],
                        ],
                    ]
                ),
                radii=np.array(
                    [
                        [
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            10.0,
                            10.0,
                            10.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            2.0,
                            2.0,
                            2.0,
                        ],
                        [
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            10.0,
                            10.0,
                            10.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            2.0,
                            2.0,
                            2.0,
                        ],
                        [
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            10.0,
                            10.0,
                            10.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            2.0,
                            2.0,
                            2.0,
                        ],
                    ]
                ),
                rotations=np.zeros((3, 17, 3)),
                n_subpoints=np.array(
                    [
                        [5, 4, 5, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                        [6, 3, 5, 5, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                        [5, 2, 4, 2, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    ]
                ),
                subpoints=np.array(
                    [
                        [
                            [
                                [36.93, 36.8, 16.78],
                                [30.55, 43.87, 19.84],
                                [24.17, 50.93, 22.9],
                                [17.78, 58.0, 25.95],
                                [11.4, 65.07, 29.01],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [36.93, 36.8, 16.78],
                                [37.2, 27.11, 19.22],
                                [37.46, 17.41, 21.66],
                                [37.73, 7.72, 24.1],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [36.93, 36.8, 16.78],
                                [40.71, 30.86, 23.88],
                                [44.5, 24.92, 30.98],
                                [48.28, 18.97, 38.07],
                                [52.07, 13.03, 45.17],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [46.08, -104.85, -2.1],
                                [45.67, -104.54, -1.9],
                                [45.26, -104.23, -1.7],
                                [44.85, -103.92, -1.5],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [53.69, 79.28, -3.09],
                                [53.6, 78.83, -3.39],
                                [53.5, 78.39, -3.7],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                        ],
                        [
                            [
                                [44.55, 33.97, 8.86],
                                [36.63, 38.27, 4.51],
                                [28.96, 43.28, 0.5],
                                [21.83, 49.61, -2.52],
                                [16.0, 57.66, -3.58],
                                [12.85, 66.92, -1.47],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [44.23, 33.56, 9.04],
                                [42.02, 24.04, 6.92],
                                [40.52, 14.33, 5.05],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [44.22, 33.18, 8.89],
                                [40.66, 24.06, 10.94],
                                [37.22, 15.1, 13.75],
                                [34.0, 6.74, 18.2],
                                [31.37, -0.07, 25.03],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [51.48, -85.75, 5.31],
                                [51.0, -85.78, 5.59],
                                [50.53, -85.82, 5.87],
                                [50.06, -85.86, 6.15],
                                [49.58, -85.9, 6.42],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [47.0, 81.7, -9.14],
                                [47.1, 81.22, -9.39],
                                [47.21, 80.74, -9.64],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                        ],
                        [
                            [
                                [44.55, 33.97, 8.86],
                                [36.63, 38.27, 4.51],
                                [28.96, 43.28, 0.5],
                                [21.83, 49.61, -2.52],
                                [16.0, 57.66, -3.58],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [44.23, 33.56, 9.04],
                                [42.02, 24.04, 6.92],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [44.22, 33.18, 8.89],
                                [40.66, 24.06, 10.94],
                                [37.22, 15.1, 13.75],
                                [34.0, 6.74, 18.2],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [51.48, -85.75, 5.31],
                                [51.0, -85.78, 5.59],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [47.0, 81.7, -9.14],
                                [47.1, 81.22, -9.39],
                                [47.21, 80.74, -9.64],
                                [47.31, 80.26, -9.89],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                            [
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                                [0.0, 0.0, 0.0],
                            ],
                        ],
                    ]
                ),
            ),
        ),
    ],
)
def test_cytosim_converter(trajectory, expected_data):
    cytosim_data = {}
    for object_type in trajectory.object_info:
        with open(trajectory.object_info[object_type].filepath, "r") as myfile:
            cytosim_data[object_type] = myfile.read().split("\n")
    agent_data = AgentData.from_dimensions(
        DimensionData(
            total_steps=1,
            max_agents=1,
            max_subpoints=1,
        )
    )
    uids = []
    for object_type in trajectory.object_info:
        agent_data, uids = CytosimConverter._parse_objects(
            object_type,
            cytosim_data[object_type],
            trajectory.meta_data.scale_factor,
            trajectory.object_info[object_type],
            agent_data,
            uids,
            DimensionData(
                total_steps=2,
                max_agents=2,
                max_subpoints=2,
            ),
        )
    assert agent_data == expected_data
